{% extends "base.html" %}

{% block content %}
<!--    <input type="text" id="searchQuery" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞...">-->
<!--    <button onclick="searchItems()">–ü–æ–∏—Å–∫</button>-->
<!--    <div id="results"></div>-->
    <form class="search_cont" method="get" action="/search">
        <input class="roboto-black search_line" type="text" name="query" value="{{ query }}" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
        <button class="roboto-black search_but" type="submit">üîç</button>
    </form>
    {% if results.__class__.__name__ == 'list' %}
    <table class="table__">
        {% for item in results %}
            <tr>
                <th>
                    <div class="block">
                        <div class="rasp" data-popup-id="popup{{ loop.index }}">
                            <img class="img_t" src="static/img/{{ item.image }}">
                            <div class="ff">
                                <div class="name_prod roboto-black">
                                    {{ item.name }}
                                </div>
                                <div class="price roboto-black">
                                    {{ item.cost }} ‚ÇΩ
                                </div>
                                <div class="podrobn roboto-black">
                                    –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
                                </div>
                            </div>
                            <div class="b-popup hidden" id="popup{{ loop.index }}">
                                <div class="b-popup-content">
                                    <img class="img_t" src="static/img/{{ item.image }}">
                                    <div class="ff-popup">
                                        <div class="name_prod roboto-black">
                                            {{ item.name }}
                                        </div>
                                        <div class="descrip roboto-black">
                                            {{ item.description.capitalize() }}
                                        </div>
                                        <div class="nijn_podt">
                                            <div class="price roboto-black">
                                                {{ item.cost }} ‚ÇΩ
                                            </div>
                                            <div class="text_marg roboto-black">
                                                –í –ö–û–†–ó–ò–ù–£
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
            </tr>
        {% endfor %}
    </table>
    {% else %}
    <div class="search_cont_none">
        <h3 class="roboto-black search_none">{{ results }}</h3>
    </div>
    {% endif %}

<script>
document.addEventListener('DOMContentLoaded', function () {
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç popup
    document.querySelectorAll('.rasp').forEach(function (element) {
        element.addEventListener('click', function () {
            const popupId = this.getAttribute('data-popup-id');
            if (popupId) {
                const popup = document.getElementById(popupId);
                if (popup) {
                    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å popup
                    popup.classList.toggle('hidden');
                }
            }
        });
    });

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è popup –ø—Ä–∏ –∫–ª–∏–∫–µ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
    document.querySelectorAll('.b-popup').forEach(function (popup) {
        popup.addEventListener('click', function (event) {
            // –ï—Å–ª–∏ –∫–ª–∏–∫ –ø—Ä–æ–∏–∑–æ—à–µ–ª –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ popup, —Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º –µ–≥–æ
            if (event.target.closest('.b-popup-content')) {
                this.classList.add('hidden');
            }
        });
    });
});
</script>
{% endblock %}